<% provide(:title, "#{@user.name}さん") %>
<div class="row">
  <aside class="col-md-4">
    <section class="user_info">
      <h1>
        <%= render 'shared/user_info' %>
      </h1>
    </section>
    <% if current_user?(@user) %>
      <div>
         <%= link_to "プロフィール編集", edit_path(current_user), class: "btn btn-x btn-primary" %>
      </div>
      <section class="micropost_form">
       <%= render 'shared/micropost_form' %>
      </section>
    <% end %>
    <section class="stats">
      <%= render 'shared/stats' %>
    </section>
  </aside>
  <div class="col-md-8">
    <%= render 'follow_form' if logged_in? %>
    <% if @user.microposts.any? %>
      <h3>糧 (<%= @user.microposts.count %>)</h3>
      <div class="micropost jscroll" >
        <ol class="microposts">
          <%= render @microposts %>
        </ol>
        <%= paginate @microposts %>
      </div>
  <% end %>
</div>
</div>

<script>
  $(window).on('scroll', function() {
      scrollHeight = $(document).height();
      scrollPosition = $(window).height() + $(window).scrollTop();
      if ( (scrollHeight - scrollPosition) / scrollHeight <= 0.05) {
            $('.jscroll').jscroll({
              contentSelector: '.micropost',
              nextSelector: 'span.next:last a'
            });
      }
  });
</script>